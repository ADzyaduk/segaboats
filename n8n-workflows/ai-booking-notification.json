{
  "name": "AI –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "booking-created",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-booking",
      "name": "Webhook: –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [180, 300],
      "webhookId": "booking-created"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://openrouter.ai/api/v1/chat/completions",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"openai/gpt-4o-mini\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"–¢—ã - –º–µ–Ω–µ–¥–∂–µ—Ä —è—Ö—Ç-–∫–ª—É–±–∞ '–í –ú–æ—Ä–µ'. –°–æ—Å—Ç–∞–≤—å –∫—Ä–∞—Ç–∫–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –æ –Ω–æ–≤–æ–º –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏. –§–æ—Ä–º–∞—Ç: –¥–µ–ª–æ–≤–æ–π, –Ω–æ –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π. –£–∫–∞–∂–∏ –í–°–ï –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∏–º—è, —Ç–µ–ª–µ—Ñ–æ–Ω, —è—Ö—Ç—É, –¥–∞—Ç—É, —á–∞—Å—ã, —Å—É–º–º—É). –ò—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏. –ü–∏—à–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º. –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –≤ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö.\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"–ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:\\n- –ö–ª–∏–µ–Ω—Ç: {{ $json.body.data.customerName }}\\n- –¢–µ–ª–µ—Ñ–æ–Ω: {{ $json.body.data.customerPhone }}\\n- –Ø—Ö—Ç–∞: {{ $json.body.data.boatName }}\\n- –î–∞—Ç–∞: {{ $json.body.data.startDate }}\\n- –ß–∞—Å–æ–≤: {{ $json.body.data.hours }}\\n- –°—É–º–º–∞: {{ $json.body.data.totalPrice }} —Ä—É–±.\\n\\n–°–æ—Å—Ç–∞–≤—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —Å —ç—Ç–∏–º–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.\"\n    }\n  ],\n  \"max_tokens\": 400,\n  \"temperature\": 0.6\n}",
        "options": {}
      },
      "id": "ai-generate-admin-msg",
      "name": "AI: –°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –∞–¥–º–∏–Ω–∞",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [400, 300],
      "credentials": {
        "httpHeaderAuth": {
          "id": "openrouter-auth",
          "name": "OpenRouter API"
        }
      }
    },
    {
      "parameters": {
        "chatId": "1231157381",
        "text": "={{ $json.choices[0].message.content }}\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìã ID: {{ $('Webhook: –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ').item.json.body.data.bookingId }}\nüìû –°–≤—è–∑–∞—Ç—å—Å—è: {{ $('Webhook: –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ').item.json.body.data.customerPhone }}\n\n‚è≥ –°—Ç–∞—Ç—É—Å: –û–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è",
        "additionalFields": {
          "replyMarkup": "inlineKeyboard",
          "inlineKeyboard": {
            "rows": [
              {
                "row": [
                  {
                    "text": "‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å",
                    "additionalFields": {
                      "callback_data": "=confirm_{{ $('Webhook: –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ').item.json.body.data ? $('Webhook: –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ').item.json.body.data.bookingId : ($('Webhook: –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ').item.json.body.bookingId || '') }}"
                    }
                  },
                  {
                    "text": "‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å",
                    "additionalFields": {
                      "callback_data": "=cancel_{{ $('Webhook: –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ').item.json.body.data ? $('Webhook: –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ').item.json.body.data.bookingId : ($('Webhook: –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ').item.json.body.bookingId || '') }}"
                    }
                  }
                ]
              },
              {
                "row": [
                  {
                    "text": "üìû –ü–æ–∑–≤–æ–Ω–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—É",
                    "additionalFields": {
                      "url": "=tel:{{ $('Webhook: –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ').item.json.body.data ? $('Webhook: –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ').item.json.body.data.customerPhone : ($('Webhook: –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ').item.json.body.customerPhone || '') }}"
                    }
                  }
                ]
              }
            ]
          }
        }
      },
      "id": "telegram-admin",
      "name": "Telegram: –ê–¥–º–∏–Ω—É",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [620, 300],
      "credentials": {
        "telegramApi": {
          "id": "telegram-bot",
          "name": "Telegram Bot"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ { \"status\": \"success\", \"message\": \"AI notification sent\" } }}"
      },
      "id": "respond-webhook",
      "name": "–û—Ç–≤–µ—Ç Webhook",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [840, 300]
    }
  ],
  "connections": {
    "Webhook: –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ": {
      "main": [
        [
          {
            "node": "AI: –°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –∞–¥–º–∏–Ω–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI: –°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –∞–¥–º–∏–Ω–∞": {
      "main": [
        [
          {
            "node": "Telegram: –ê–¥–º–∏–Ω—É",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Telegram: –ê–¥–º–∏–Ω—É": {
      "main": [
        [
          {
            "node": "–û—Ç–≤–µ—Ç Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": ["booking", "notification", "ai"],
  "triggerCount": 0,
  "updatedAt": "2026-01-21T16:00:00.000Z",
  "versionId": "3"
}
